# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¡ãƒ¢ãƒª - å®Ÿé¨“ãƒãƒ¼ãƒˆæ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ  v3.0

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- **Framework**: Next.js 15 (App Router)
- **Language**: TypeScript 5.x
- **UI Library**: React 19
- **Styling**: Tailwind CSS 3.x
- **Markdown Rendering**: React Markdown 9.x
- **Testing**: Playwright 1.x (E2E)
- **Package Manager**: npm

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- **Language**: Python 3.12+
- **Web Framework**: FastAPI 0.115+
- **LLM Orchestration**: LangChain 0.3.13+, LangGraph 0.2.62+
- **Vector Database**: ChromaDB 0.6.3+
- **Embeddings**: OpenAI SDK 1.59+
- **Reranking**: Cohere SDK 5.14+
- **Data Validation**: Pydantic 2.x
- **Config Management**: PyYAML 6.0+

### ã‚¤ãƒ³ãƒ•ãƒ©
- **Frontend Hosting**: Vercel
- **Backend**: Google Cloud Run (ã‚³ãƒ³ãƒ†ãƒŠ)
- **Storage**: Google Cloud Storage (GCS)
- **Database**: ChromaDB (æ°¸ç¶šåŒ– on GCS)
- **Container**: Docker

---

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
jikkennote-search/
â”œâ”€â”€ .claude/                 # Claude Codeé–‹ç™ºç’°å¢ƒè¨­å®š
â”‚   â”œâ”€â”€ agents/             # ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾©
â”‚   â”œâ”€â”€ commands/           # ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒãƒ³ãƒ‰ï¼ˆadd-feature, review-docsãªã©ï¼‰
â”‚   â”œâ”€â”€ skills/             # ã‚¹ã‚­ãƒ«å®šç¾©ï¼ˆsteering, prd-writingç­‰ï¼‰
â”‚   â””â”€â”€ settings.json       # Claude Codeè¨­å®š
â”‚
â”œâ”€â”€ .steering/              # ä½œæ¥­å˜ä½ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â””â”€â”€ [æ—¥ä»˜]-[æ©Ÿèƒ½å]/   # æ©Ÿèƒ½ã”ã¨ã®ãƒ•ã‚©ãƒ«ãƒ€
â”‚       â”œâ”€â”€ requirements.md # è¦ä»¶å®šç¾©
â”‚       â”œâ”€â”€ design.md       # è¨­è¨ˆæ›¸
â”‚       â””â”€â”€ tasklist.md     # ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ
â”‚
â”œâ”€â”€ frontend/                # Next.js ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â”‚   â”œâ”€â”€ app/                # App Router ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ page.tsx       # ãƒ›ãƒ¼ãƒ ï¼ˆãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ï¼‰
â”‚   â”‚   â”œâ”€â”€ search/        # æ¤œç´¢ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ viewer/        # ãƒãƒ¼ãƒˆãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼
â”‚   â”‚   â”œâ”€â”€ ingest/        # ãƒãƒ¼ãƒˆå–ã‚Šè¾¼ã¿
â”‚   â”‚   â”œâ”€â”€ dictionary/    # è¾æ›¸ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ evaluate/      # RAGè©•ä¾¡
â”‚   â”‚   â””â”€â”€ settings/      # è¨­å®šï¼ˆAPIã‚­ãƒ¼ã€ãƒ¢ãƒ‡ãƒ«ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼‰
â”‚   â”œâ”€â”€ components/        # å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆäºˆå®šï¼‰
â”‚   â”œâ”€â”€ lib/              # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆäºˆå®šï¼‰
â”‚   â”œâ”€â”€ tests/            # E2Eãƒ†ã‚¹ãƒˆ
â”‚   â””â”€â”€ package.json      # ä¾å­˜é–¢ä¿‚
â”‚
â”œâ”€â”€ backend/              # FastAPI ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
â”‚   â”œâ”€â”€ server.py        # ãƒ¡ã‚¤ãƒ³APIã‚µãƒ¼ãƒãƒ¼
â”‚   â”œâ”€â”€ agent.py         # LangGraph ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
â”‚   â”œâ”€â”€ ingest.py        # ãƒãƒ¼ãƒˆå–ã‚Šè¾¼ã¿ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”œâ”€â”€ utils.py         # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
â”‚   â”œâ”€â”€ chroma_sync.py   # ChromaDBç®¡ç†
â”‚   â”œâ”€â”€ storage.py       # ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æŠ½è±¡åŒ–ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«/GCSï¼‰
â”‚   â”œâ”€â”€ prompt_manager.py # ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç®¡ç†
â”‚   â”œâ”€â”€ config.py        # è¨­å®šç®¡ç†
â”‚   â”œâ”€â”€ master_dictionary.yaml # æ­£è¦åŒ–è¾æ›¸
â”‚   â”œâ”€â”€ chroma_db_config.json  # ChromaDBè¨­å®š
â”‚   â”œâ”€â”€ saved_prompts/   # ä¿å­˜ã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆYAMLï¼‰â­ v3.0: prompts/ã‹ã‚‰åç§°å¤‰æ›´
â”‚   â””â”€â”€ requirements.txt # Pythonä¾å­˜é–¢ä¿‚
â”‚
â”œâ”€â”€ docs/                # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ ideas/          # åˆæœŸè¦ä»¶ã€ã‚¢ã‚¤ãƒ‡ã‚¢ãƒ¡ãƒ¢
â”‚   â”‚   â”œâ”€â”€ initial-requirements.md
â”‚   â”‚   â”œâ”€â”€ v1-improvements.md
â”‚   â”‚   â””â”€â”€ brainstorm-*.md
â”‚   â”œâ”€â”€ archive/        # ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã•ã‚ŒãŸæ—§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ product-requirements.md    # ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆè¦æ±‚å®šç¾©æ›¸
â”‚   â”œâ”€â”€ functional-design.md       # æ©Ÿèƒ½è¨­è¨ˆæ›¸
â”‚   â”œâ”€â”€ architecture.md            # æŠ€è¡“ä»•æ§˜æ›¸
â”‚   â”œâ”€â”€ api-specification.md       # APIä»•æ§˜æ›¸
â”‚   â”œâ”€â”€ repository-structure.md    # ãƒªãƒã‚¸ãƒˆãƒªæ§‹é€ å®šç¾©æ›¸
â”‚   â”œâ”€â”€ development-guidelines.md  # é–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³
â”‚   â””â”€â”€ glossary.md               # ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªå®šç¾©
â”‚
â”œâ”€â”€ CLAUDE.md           # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¡ãƒ¢ãƒªï¼‰
â”œâ”€â”€ README.md           # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
â”œâ”€â”€ DEPLOYMENT.md       # ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †æ›¸
â”œâ”€â”€ USER_MANUAL.md      # ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒ‹ãƒ¥ã‚¢ãƒ«
â””â”€â”€ PRODUCTION_TEST_CHECKLIST.md  # ãƒ†ã‚¹ãƒˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
```

---

## é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹

### åŸºæœ¬ãƒ•ãƒ­ãƒ¼

1. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¢ºèª**: æ°¸ç¶šãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ(`docs/`)ã§ã€Œä½•ã‚’ä½œã‚‹ã‹ã€ã‚’ç¢ºèª
2. **å®Ÿè£…**: æ©Ÿèƒ½è¦ä»¶ã«åŸºã¥ã„ã¦å®Ÿè£…
3. **ãƒ†ã‚¹ãƒˆ**: E2Eãƒ†ã‚¹ãƒˆï¼ˆPlaywrightï¼‰ã€APIãƒ†ã‚¹ãƒˆï¼ˆæ‰‹å‹•ï¼‰
4. **ãƒ‡ãƒ—ãƒ­ã‚¤**: Vercelï¼ˆãƒ•ãƒ­ãƒ³ãƒˆï¼‰ã€Google Cloud Runï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰
5. **æ›´æ–°**: å¿…è¦ã«å¿œã˜ã¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°

### é‡è¦ãªãƒ«ãƒ¼ãƒ«

#### å®Ÿè£…å‰ã®ç¢ºèª

æ–°ã—ã„å®Ÿè£…ã‚’å§‹ã‚ã‚‹å‰ã«ã€å¿…ãšä»¥ä¸‹ã‚’ç¢ºèª:

1. ã“ã®CLAUDE.mdã‚’èª­ã‚€
2. é–¢é€£ã™ã‚‹æ°¸ç¶šãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ(`docs/`)ã‚’èª­ã‚€
3. `.steering/`é…ä¸‹ã®é–¢é€£ã™ã‚‹ä½œæ¥­å˜ä½ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç¢ºèª
4. Grepã§æ—¢å­˜ã®é¡ä¼¼å®Ÿè£…ã‚’æ¤œç´¢
5. æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç†è§£ã—ã¦ã‹ã‚‰å®Ÿè£…é–‹å§‹

#### ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

**TypeScript**:
- å³å¯†ãªå‹å®šç¾©ï¼ˆ`strict: true`ï¼‰
- é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°æ¨å¥¨
- Async/Await ä½¿ç”¨
- å‘½å: camelCaseï¼ˆé–¢æ•°ãƒ»å¤‰æ•°ï¼‰ã€PascalCaseï¼ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ»å‹ï¼‰

**Python**:
- PEP 8 æº–æ‹ 
- Type hints å¿…é ˆ
- Docstring è¨˜è¿°
- å‘½å: snake_caseï¼ˆé–¢æ•°ãƒ»å¤‰æ•°ï¼‰ã€PascalCaseï¼ˆã‚¯ãƒ©ã‚¹ï¼‰

#### Git ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

```
<type>: <subject>

<body>

<footer>
```

**Type**:
- `Feat`: æ–°æ©Ÿèƒ½
- `Fix`: ãƒã‚°ä¿®æ­£
- `Docs`: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `Style`: ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
- `Refactor`: ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
- `Test`: ãƒ†ã‚¹ãƒˆ
- `Chore`: ãƒ“ãƒ«ãƒ‰ã€ãƒ„ãƒ¼ãƒ«å¤‰æ›´

---

## ä½œæ¥­å˜ä½ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†

### .steeringãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

æ©Ÿèƒ½è¿½åŠ ã‚„æ”¹å–„ä½œæ¥­ã”ã¨ã«ã€`.steering/[æ—¥ä»˜]-[æ©Ÿèƒ½å]/`é…ä¸‹ã«ä½œæ¥­å˜ä½ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ**:
```
.steering/
â””â”€â”€ 20251230-Google-Driveçµ±åˆ/
    â”œâ”€â”€ requirements.md   # è¦ä»¶å®šç¾©ï¼ˆæ©Ÿèƒ½ã®ç›®çš„ã€ã‚¹ã‚³ãƒ¼ãƒ—ã€åˆ¶ç´„ï¼‰
    â”œâ”€â”€ design.md         # è¨­è¨ˆæ›¸ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã€APIè¨­è¨ˆã€UIè¨­è¨ˆï¼‰
    â””â”€â”€ tasklist.md       # ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆï¼ˆå®Ÿè£…ã™ã¹ãã‚¿ã‚¹ã‚¯ã®ä¸€è¦§ã€ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ä»˜ãï¼‰
```

**å‘½åè¦å‰‡**:
- ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå: `YYYYMMDD-[æ©Ÿèƒ½å]`ï¼ˆä¾‹: `20251230-Google-Driveçµ±åˆ`ï¼‰
- ãƒ•ã‚¡ã‚¤ãƒ«å: å›ºå®šï¼ˆ`requirements.md`, `design.md`, `tasklist.md`ï¼‰

**é‹ç”¨ãƒ«ãƒ¼ãƒ«**:

1. **ä½œæ¥­é–‹å§‹æ™‚**:
   - `/add-feature [æ©Ÿèƒ½å]`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ
   - ã‚¹ãƒ†ã‚¢ãƒªãƒ³ã‚°ãƒ•ã‚¡ã‚¤ãƒ«3ç‚¹ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹
   - `requirements.md`: æ©Ÿèƒ½ã®ç›®çš„ã€åˆ¶ç´„ã€æˆåŠŸåŸºæº–ã‚’è¨˜è¼‰
   - `design.md`: ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã€APIè¨­è¨ˆã€UIè¨­è¨ˆã‚’è¨˜è¼‰
   - `tasklist.md`: å®Ÿè£…ã™ã¹ãã‚¿ã‚¹ã‚¯ã‚’ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹å½¢å¼ã§è¨˜è¼‰

2. **å®Ÿè£…ä¸­**:
   - `tasklist.md`ã®å…ˆé ­ã‹ã‚‰é †ã«ã‚¿ã‚¹ã‚¯ã‚’å®Ÿæ–½
   - å®Œäº†ã—ãŸã‚¿ã‚¹ã‚¯ã«`[x]`ã‚’ãƒãƒ¼ã‚¯ã™ã‚‹
   - ã‚¿ã‚¹ã‚¯ãŒå¤§ãã™ãã‚‹å ´åˆã¯ã‚µãƒ–ã‚¿ã‚¹ã‚¯ã«åˆ†å‰²
   - æŠ€è¡“çš„ç†ç”±ã§ã‚¿ã‚¹ã‚¯ãŒä¸è¦ã«ãªã£ãŸå ´åˆã¯ç†ç”±ã‚’æ˜è¨˜ã—ã¦ã‚¹ã‚­ãƒƒãƒ—

3. **å®Ÿè£…å®Œäº†å¾Œ**:
   - å…¨ã‚¿ã‚¹ã‚¯å®Œäº†ã‚’ç¢ºèª
   - `tasklist.md`ã«æŒ¯ã‚Šè¿”ã‚Šã‚’è¨˜è¼‰ï¼ˆå®Ÿè£…å®Œäº†æ—¥ã€è¨ˆç”»ã¨å®Ÿç¸¾ã®å·®åˆ†ã€å­¦ã‚“ã ã“ã¨ï¼‰
   - å¿…è¦ã«å¿œã˜ã¦æ°¸ç¶šãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ(`docs/`)ã‚’æ›´æ–°

**steeringã‚¹ã‚­ãƒ«ã¨ã®é€£æº**:
- `.claude/skills/steering/SKILL.md`ã‚’å‚ç…§
- **è¨ˆç”»ãƒ¢ãƒ¼ãƒ‰**: ã‚¹ãƒ†ã‚¢ãƒªãƒ³ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆæ™‚ã«ä½¿ç”¨
- **å®Ÿè£…ãƒ¢ãƒ¼ãƒ‰**: tasklist.mdã«å¾“ã£ãŸå®Ÿè£…æ™‚ã«ä½¿ç”¨
- **æŒ¯ã‚Šè¿”ã‚Šãƒ¢ãƒ¼ãƒ‰**: å®Ÿè£…å®Œäº†å¾Œã®è¨˜éŒ²æ™‚ã«ä½¿ç”¨

**ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**:
- `.claude/skills/steering/templates/requirements.md`
- `.claude/skills/steering/templates/design.md`
- `.claude/skills/steering/templates/tasklist.md`

è©³ç´°ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¯ `.claude/commands/add-feature.md` ã‚’å‚ç…§ã€‚

---

## ãƒ‡ãƒ¼ã‚¿ç®¡ç†æˆ¦ç•¥

### ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æ§‹æˆ

#### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ

```
backend/
â”œâ”€â”€ notes/
â”‚   â”œâ”€â”€ new/         # æ–°è¦ãƒãƒ¼ãƒˆ
â”‚   â””â”€â”€ processed/   # å–ã‚Šè¾¼ã¿æ¸ˆã¿ãƒãƒ¼ãƒˆï¼ˆå‰Šé™¤ã—ãªã„ï¼‰â­ v3.0: archived/ã‹ã‚‰åç§°å¤‰æ›´
â”œâ”€â”€ chroma_db/       # ChromaDBæ°¸ç¶šåŒ–
â”œâ”€â”€ saved_prompts/   # ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆYAML â­ v3.0: prompts/ã‹ã‚‰åç§°å¤‰æ›´
â””â”€â”€ master_dictionary.yaml  # æ­£è¦åŒ–è¾æ›¸
```

#### æœ¬ç•ªç’°å¢ƒï¼ˆGCSï¼‰

```
gs://jikkennote-storage/
â””â”€â”€ teams/           # v3.0: ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œ
    â””â”€â”€ {team_id}/
        â”œâ”€â”€ chroma-db/       # ChromaDBæ°¸ç¶šåŒ–
        â”œâ”€â”€ notes/
        â”‚   â”œâ”€â”€ new/
        â”‚   â””â”€â”€ processed/   # v3.0: archived/ã‹ã‚‰åç§°å¤‰æ›´
        â”œâ”€â”€ saved_prompts/   # v3.0: prompts/ã‹ã‚‰åç§°å¤‰æ›´
        â””â”€â”€ dictionary.yaml
```

### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

#### æ¤œç´¢ãƒ•ãƒ­ãƒ¼

```
User Input (ç›®çš„ãƒ»ææ–™ãƒ»æ–¹æ³•ãƒ»é‡ç‚¹æŒ‡ç¤º)
  â†“
Frontend (Search Page) â†’ API Request
  â†“
Backend (/search)
  â”œâ”€â†’ Normalize Node (utils.py: ææ–™åæ­£è¦åŒ–)
  â”œâ”€â†’ Query Generation Node (agent.py: 3è¦–ç‚¹ã‚¯ã‚¨ãƒªç”Ÿæˆ)
  â”œâ”€â†’ Search Node (ChromaDBæ¤œç´¢ + Cohere Reranking)
  â””â”€â†’ Compare Node (ä¸Šä½3ä»¶ã®æ¯”è¼ƒåˆ†æ)
  â†“
SearchResponse (retrieved_docs: Markdown[] )
  â†“
Frontend (çµæœè¡¨ç¤º + æ¤œç´¢å±¥æ­´ä¿å­˜)
```

#### ãƒãƒ¼ãƒˆå–ã‚Šè¾¼ã¿ãƒ•ãƒ­ãƒ¼

```
User Action: ãƒãƒ¼ãƒˆé…ç½®ï¼ˆ3ã¤ã®æ–¹æ³•ï¼‰
  1. ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆUIã‹ã‚‰ç›´æ¥ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼‰â­ æ¨å¥¨
  2. Google Driveé€£æºï¼ˆéITç³»ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã€è‡ªå‹•ç›£è¦–ï¼‰
  3. GCSç›´æ¥é…ç½®ï¼ˆé–‹ç™ºè€…ã®ã¿ã€v3.0ã§ã¯éæ¨å¥¨ï¼‰
  â†“
Backend (/ingest)
  â”œâ”€â†’ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯Google Driveã‹ã‚‰å–å¾—
  â”œâ”€â†’ notes/new/ ã«ä¸€æ™‚ä¿å­˜
  â”œâ”€â†’ æ—¢å­˜IDç¢ºèªï¼ˆå¢—åˆ†æ›´æ–°ï¼‰
  â”œâ”€â†’ æ–°å‡ºå˜èªæŠ½å‡ºï¼ˆ/ingest/analyzeï¼‰
  â”‚     â”œâ”€â†’ LLMã§é¡ä¼¼å€™è£œæ¤œç´¢
  â”‚     â””â”€â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¤å®šï¼ˆæ–°è¦/è¡¨è¨˜æºã‚Œ/ã‚¹ã‚­ãƒƒãƒ—ï¼‰
  â”œâ”€â†’ æ­£è¦åŒ–è¾æ›¸æ›´æ–°ï¼ˆ/dictionary/updateï¼‰
  â”œâ”€â†’ Embeddingç”Ÿæˆ â†’ ChromaDBè¿½åŠ 
  â”œâ”€â†’ ChromaDB â†’ GCSåŒæœŸ
  â””â”€â†’ ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†ï¼ˆprocessed/ã¸ç§»å‹•ã€å‰Šé™¤ã—ãªã„ï¼‰â­ v3.0å¤‰æ›´
  â†“
IngestResponse (new_notes: string[], skipped_notes: string[])
```

**éITç³»ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘é…æ…®ï¼ˆv3.0æ–°è¦ï¼‰**:
- **ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**: ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ç›´æ¥ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å¯¾å¿œï¼‰
- **Google Driveé€£æº**: Google Driveãƒ•ã‚©ãƒ«ãƒ€ã‚’æŒ‡å®šã™ã‚‹ã¨ã€å®šæœŸçš„ã«æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•å–ã‚Šè¾¼ã¿
- **GCSæ–¹å¼ã®å»ƒæ­¢**: GCSã«ç›´æ¥ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã™ã‚‹æ–¹å¼ã¯å°‚é–€çŸ¥è­˜ãŒå¿…è¦ãªãŸã‚ã€v3.0ã§éæ¨å¥¨åŒ–
- **ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æ–¹é‡**: å–ã‚Šè¾¼ã¿æ¸ˆã¿ãƒãƒ¼ãƒˆã¯`processed/`ã«ç§»å‹•ã—ã€å‰Šé™¤ã—ãªã„ï¼ˆEmbeddingãƒ¢ãƒ‡ãƒ«å¤‰æ›´æ™‚ã®å†å–ã‚Šè¾¼ã¿ã«å¯¾å¿œï¼‰

---

## APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¨­è¨ˆ

### ã‚³ã‚¢æ©Ÿèƒ½
- `POST /search` - å®Ÿé¨“ãƒãƒ¼ãƒˆæ¤œç´¢
  - v3.0.1: ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢å¯¾å¿œï¼ˆ`search_mode`, `hybrid_alpha`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¿½åŠ ï¼‰
  - æ¤œç´¢ãƒ¢ãƒ¼ãƒ‰: ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰
- `POST /ingest` - ãƒãƒ¼ãƒˆå–ã‚Šè¾¼ã¿ï¼ˆå¢—åˆ†æ›´æ–°ï¼‰
- `GET /notes/{id}` - ãƒãƒ¼ãƒˆå–å¾—

### ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç®¡ç†
- `GET /prompts` - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå–å¾—
- `GET /prompts/list` - ä¿å­˜æ¸ˆã¿ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¸€è¦§
- `POST /prompts/save` - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¿å­˜
- `GET /prompts/load/{name}` - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆèª­ã¿è¾¼ã¿
- `DELETE /prompts/delete/{name}` - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå‰Šé™¤
- `PUT /prompts/update` - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ›´æ–°

### æ­£è¦åŒ–è¾æ›¸ç®¡ç†
- `GET /dictionary` - è¾æ›¸å–å¾—
- `POST /dictionary/update` - è¾æ›¸æ›´æ–°
- `GET /dictionary/export` - è¾æ›¸ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆYAML/JSON/CSVï¼‰
- `POST /dictionary/import` - è¾æ›¸ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

### ChromaDBç®¡ç†
- `GET /chroma/info` - ç¾åœ¨ã®Embeddingãƒ¢ãƒ‡ãƒ«æƒ…å ±
- `POST /chroma/reset` - ChromaDBãƒªã‚»ãƒƒãƒˆ

### è©•ä¾¡æ©Ÿèƒ½
- `POST /evaluate/import` - ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆExcel/CSVï¼‰
- `POST /evaluate` - RAGæ€§èƒ½è©•ä¾¡

### ãã®ä»–
- `GET /health` - ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- `GET /config/folders` - ãƒ•ã‚©ãƒ«ãƒ€ãƒ‘ã‚¹å–å¾—
- `POST /config/folders` - ãƒ•ã‚©ãƒ«ãƒ€ãƒ‘ã‚¹æ›´æ–°

è©³ç´°ã¯ `/backend/server.py` ã¾ãŸã¯ `docs/api-specification.md` ã‚’å‚ç…§ã€‚

---

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ

### APIã‚­ãƒ¼ç®¡ç†

**ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**:
- localStorage ã«ä¿å­˜ï¼ˆå¹³æ–‡ï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰‹å‹•ã§å…¥åŠ›
- ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«ãƒ˜ãƒƒãƒ€ãƒ¼ã¾ãŸã¯ãƒœãƒ‡ã‚£ã§é€ä¿¡
- HTTPSé€šä¿¡ã®ã¿

**ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**:
- APIã‚­ãƒ¼ã¯ã‚µãƒ¼ãƒãƒ¼ã«ä¿å­˜ã—ãªã„
- ãƒªã‚¯ã‚¨ã‚¹ãƒˆã”ã¨ã«å—ã‘å–ã‚Šã€ä¸€æ™‚çš„ã«ãƒ¡ãƒ¢ãƒªã§ä½¿ç”¨
- ãƒ­ã‚°ã«å‡ºåŠ›ã—ãªã„

### CORSè¨­å®š

```python
# server.py
app.add_middleware(
    CORSMiddleware,
    allow_origins=[
        "http://localhost:3000",  # ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º
        os.getenv("FRONTEND_URL", "https://your-app.vercel.app")  # æœ¬ç•ªç’°å¢ƒ
    ],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

---

## ãƒ‡ãƒ—ãƒ­ã‚¤æˆ¦ç•¥

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆVercelï¼‰

```bash
# GitHubé€£æºã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
# main ãƒ–ãƒ©ãƒ³ãƒãƒ—ãƒƒã‚·ãƒ¥ â†’ è‡ªå‹•ãƒ“ãƒ«ãƒ‰&ãƒ‡ãƒ—ãƒ­ã‚¤

# ç’°å¢ƒå¤‰æ•°
NEXT_PUBLIC_API_URL=https://jikkennote-backend-xxx.run.app
```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆGoogle Cloud Runï¼‰

```bash
# 1. Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰
docker build -t asia-northeast1-docker.pkg.dev/PROJECT_ID/jikkennote-repo/backend:latest backend/

# 2. Artifact Registryã«ãƒ—ãƒƒã‚·ãƒ¥
docker push asia-northeast1-docker.pkg.dev/PROJECT_ID/jikkennote-repo/backend:latest

# 3. Cloud Runãƒ‡ãƒ—ãƒ­ã‚¤
gcloud run deploy jikkennote-backend \
  --image asia-northeast1-docker.pkg.dev/PROJECT_ID/jikkennote-repo/backend:latest \
  --region asia-northeast1 \
  --platform managed \
  --allow-unauthenticated \
  --memory 2Gi \
  --cpu 2 \
  --set-env-vars STORAGE_TYPE=gcs,GCS_BUCKET_NAME=jikkennote-storage
```

### ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆGoogle Cloud Storageï¼‰

```bash
# ãƒã‚±ãƒƒãƒˆä½œæˆ
gcloud storage buckets create gs://jikkennote-storage --location=asia-northeast1

# ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ä½œæˆ
gsutil mkdir gs://jikkennote-storage/chroma-db
gsutil mkdir gs://jikkennote-storage/notes
gsutil mkdir gs://jikkennote-storage/prompts

# åˆæœŸãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
gsutil cp master_dictionary.yaml gs://jikkennote-storage/
```

---

## ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### E2Eãƒ†ã‚¹ãƒˆï¼ˆPlaywrightï¼‰

```bash
cd frontend
npm test                                # å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm test tests/e2e/prompt-management.spec.ts  # ç‰¹å®šãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npx playwright test --debug             # ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰
```

**ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**:
- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç®¡ç†æ©Ÿèƒ½ âœ…
- è©•ä¾¡æ©Ÿèƒ½ âœ…
- ãã®ä»–ï¼ˆæ¤œç´¢ã€ãƒãƒ¼ãƒˆå–ã‚Šè¾¼ã¿ï¼‰ã¯æ‰‹å‹•ãƒ†ã‚¹ãƒˆ

### APIãƒ†ã‚¹ãƒˆ

```bash
# cURLã§ã®ãƒ†ã‚¹ãƒˆ
curl -X POST "http://localhost:8000/search" \
  -H "Content-Type: application/json" \
  -d '{
    "purpose": "ãƒ†ã‚¹ãƒˆ",
    "materials": "ã‚¨ã‚¿ãƒãƒ¼ãƒ«",
    "methods": "æ”ªæ‹Œ",
    "openai_api_key": "sk-proj-...",
    "cohere_api_key": "..."
  }' | jq .
```

---

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™

| æŒ‡æ¨™ | ç›®æ¨™å€¤ |
|------|-------|
| æ¤œç´¢ãƒ¬ã‚¹ãƒãƒ³ã‚¹ | < 5ç§’ |
| ãƒãƒ¼ãƒˆå–ã‚Šè¾¼ã¿ | < 10ç§’/ä»¶ |
| æ–°å‡ºå˜èªæŠ½å‡º | < 10ç§’/ãƒãƒ¼ãƒˆ |
| ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰ | < 2ç§’ |
| APIå¿œç­”æ™‚é–“ | < 3ç§’ |

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ChromaDBäº’æ›æ€§ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: Embeddingãƒ¢ãƒ‡ãƒ«å¤‰æ›´å¾Œã€æ¤œç´¢ã‚¨ãƒ©ãƒ¼

**å¯¾å‡¦**:
1. è¨­å®šãƒšãƒ¼ã‚¸ã§ã€ŒChromaDBã‚’ãƒªã‚»ãƒƒãƒˆã€
2. å…¨ãƒãƒ¼ãƒˆå†å–ã‚Šè¾¼ã¿
3. Embedding ãƒ¢ãƒ‡ãƒ«ç¢ºèª

### æ¤œç´¢çµæœãŒä¸æ­£ç¢º

**å¯¾å‡¦**:
1. æ­£è¦åŒ–è¾æ›¸ã«ææ–™åã‚’è¿½åŠ ï¼ˆ/dictionaryï¼‰
2. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç·¨é›†ï¼ˆè¨­å®šãƒšãƒ¼ã‚¸ï¼‰
3. è©•ä¾¡æ©Ÿèƒ½ã§nDCGæ¸¬å®š

### ãƒãƒ¼ãƒˆå–ã‚Šè¾¼ã¿ã‚¨ãƒ©ãƒ¼

**å¯¾å‡¦**:
1. Markdownå½¢å¼ï¼ˆ.mdï¼‰ç¢ºèª
2. ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ§‹é€ ç¢ºèªï¼ˆ## ææ–™ã€## æ–¹æ³•ï¼‰
3. APIã‚­ãƒ¼ç¢ºèª

---

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†ã®åŸå‰‡

### æ°¸ç¶šçš„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ(`docs/`)

- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ã€Œä½•ã‚’ä½œã‚‹ã‹ã€ã€Œã©ã†ä½œã‚‹ã‹ã€ã‚’å®šç¾©
- é »ç¹ã«æ›´æ–°ã•ã‚Œãªã„
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã€ŒåŒ—æ¥µæ˜Ÿã€

### ã‚¢ã‚¤ãƒ‡ã‚¢ãƒ¡ãƒ¢(`docs/ideas/`)

- å£æ‰“ã¡ãƒ»ãƒ–ãƒ¬ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒŸãƒ³ã‚°ã®æˆæœç‰©
- æŠ€è¡“èª¿æŸ»ãƒ¡ãƒ¢
- è‡ªç”±å½¢å¼ï¼ˆæ§‹é€ åŒ–ã¯æœ€å°é™ï¼‰

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¡ãƒ¢ãƒª(ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«)

- æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã€é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 
- é–‹ç™ºè€…ãŒæœ€åˆã«èª­ã‚€ã¹ãæƒ…å ±
- å®Ÿè£…æ™‚ã®æŒ‡é‡

---

## ãƒªãƒªãƒ¼ã‚¹å±¥æ­´

- **v3.0.3** (2026-01-02) - Phase 2ã‚³ã‚¢æ¤œç´¢æ©Ÿèƒ½å¼·åŒ–å®Œäº†ï¼ˆ2æ®µéšãƒ¢ãƒ‡ãƒ«é¸æŠã€ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢ï¼‰â­
- **v3.0.2** (2025-12-30) - CLAUDE.mdæ”¹å–„ï¼ˆä½œæ¥­å˜ä½ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†ã€éITç³»ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘é…æ…®ã‚’æ˜è¨˜ï¼‰ğŸ“
- **v3.0.1** (2025-12-30) - ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢æ©Ÿèƒ½è¿½åŠ  â­
- **v3.0.0** (2025-12-29) - v1æ”¹å–„ç‚¹å®Ÿè£…å®Œäº†ï¼ˆãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆã€ãƒãƒ¼ãƒˆå–ã‚Šè¾¼ã¿æ”¹å–„ã€ãƒ¢ãƒ‡ãƒ«2æ®µéšé¸æŠãªã©ï¼‰
- **v2.0.5** (2025-12-19) - Phase 6 ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå®Œäº† ğŸ‰
- **v2.0.4** (2025-12-19) - Phase 5 UI/UXæ”¹å–„ãƒ»ãƒ†ã‚¹ãƒˆå®Œäº†
- **v2.0.3** (2025-12-19) - Phase 4 å±¥æ­´ãƒ»è©•ä¾¡æ©Ÿèƒ½å®Ÿè£…å®Œäº†
- **v2.0.2** (2025-12-19) - Phase 3 ãƒãƒ¼ãƒˆç®¡ç†ãƒ»è¾æ›¸æ©Ÿèƒ½å®Ÿè£…å®Œäº†
- **v2.0.1** (2025-12-19) - Phase 2 ã‚³ã‚¢æ©Ÿèƒ½å®Ÿè£…å®Œäº†
- **v2.0.0** (2025-12-19) - Phase 1 åŸºç›¤æ•´å‚™å®Œäº†
- **v1.0.0** - æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ï¼ˆLangChain_v2ï¼‰

---

## å‚è€ƒãƒªãƒ³ã‚¯

### å†…éƒ¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [åˆæœŸè¦ä»¶ãƒ»ã‚¢ã‚¤ãƒ‡ã‚¢ãƒ¡ãƒ¢](docs/ideas/initial-requirements.md)
- [ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆè¦æ±‚å®šç¾©æ›¸](docs/product-requirements.md)
- [æ©Ÿèƒ½è¨­è¨ˆæ›¸](docs/functional-design.md)
- [æŠ€è¡“ä»•æ§˜æ›¸](docs/architecture.md)
- [APIä»•æ§˜æ›¸](docs/api-specification.md)
- [é–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³](docs/development-guidelines.md)
- [ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒ‹ãƒ¥ã‚¢ãƒ«](USER_MANUAL.md)
- [ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †æ›¸](DEPLOYMENT.md)

### å¤–éƒ¨ãƒªã‚½ãƒ¼ã‚¹
- [LangChain Documentation](https://python.langchain.com/)
- [ChromaDB Documentation](https://docs.trychroma.com/)
- [Next.js Documentation](https://nextjs.org/docs)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [Google Cloud Run Documentation](https://cloud.google.com/run/docs)

---

**ä½œæˆæ—¥**: 2025-12-19
**æœ€çµ‚æ›´æ–°**: 2025-12-30
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 3.0.2 (ä½œæ¥­å˜ä½ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†ã€éITç³»ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘é…æ…®ã‚’æ˜è¨˜)
**ç®¡ç†è€…**: é–‹ç™ºãƒãƒ¼ãƒ 
